asm(
  ".section h0; .set h0,0x598E80;"
  "push ebp;"
  "mov ebp,esp;"
  "and esp,0xFFFFFFF8;"
  "push ecx;"
  "push ebp;"
  "push esi;"
  "push edi;"
  "mov edi,ecx;"
  "cmp byte ptr [edi+0x40], bl;"
  "je L0xABEL_0x598F6C;"
  "mov ecx,dword ptr [edi+0x44];"
  "mov eax,dword ptr [ecx+0x10];"
  "test eax,eax;"
  "je L0xABEL_0x598EB5;"
  "mov edx,dword ptr [ecx+0x14];"
  "sub edx,eax;"
  "sar edx,0x3;"
  "je L0xABEL_0x598EB5;"
  "mov eax,dword ptr [eax];"
  "test eax,eax;"
  "je L0xABEL_0x598EB5;"
  "lea esi,dword ptr [eax-0x4];"
  "jmp L0xABEL_0x598EB7;"
  "L0xABEL_0x598EB5:;"
  "xor esi,esi;"
  "L0xABEL_0x598EB7:;"
  "mov edx,0x2;"
  "cmp dword ptr [edi+0x2C],edx;"
  "mov byte ptr [edi+0x40], bl;"
  "jne L0xABEL_0x598EEC;"
  "mov esi,dword ptr [esi+0x98];"
  "sub esi,0xA;"
  "je L0xABEL_0x598F66;"
  "sub esi,0x6;"
  "je L0xABEL_0x598EE1;"
  "sub esi,edx;"
  "jne L0xABEL_0x598F66;"
  "L0xABEL_0x598EE1:;"
  "push ecx;"
  "call 0x6EDFC0;"
  "jmp L0xABEL_0x598F6C;"
  "L0xABEL_0x598EEC:;"
  //CRASH FIX (null pointer)
  "cmp esi, ebx;"
  "je RETURN1;"
  //------------------------
  "mov eax,dword ptr [esi+0xE4];"
  "cmp eax,0x1;"
  "jle L0xABEL_0x598F09;"
  "add eax,0xFFFFFFFF;"
  "mov dword ptr [esi+0xE4],eax;"
  "mov byte ptr [esi+0x141],0x1;"
  "jmp L0xABEL_0x598F6C;"
  "L0xABEL_0x598F09:;"
  "mov ebp,dword ptr [edi+0x1C];"
  "cmp byte ptr [ebp+0x2A2],bl;"
  "je L0xABEL_0x598F46;"
  "cmp dword ptr [esi+0x98],0x7;"
  "jne L0xABEL_0x598F46;"
  "mov eax,dword ptr [esi+0xE0];"
  "mov dword ptr [esi+0xE4],eax;"
  "mov byte ptr [esi+0x141],0x1;"
  "mov ecx,dword ptr [edi+0x44];"
  "push ecx;"
  "call 0x6EDFC0;"
  "L0xABEL_0x598F3A:;"
  "RETURN1:;"
  "mov eax,0x1;"
  "pop edi;"
  "pop esi;"
  "pop ebp;"
  "mov esp,ebp;"
  "pop ebp;"
  "ret;"
  "L0xABEL_0x598F46:;"
  "mov eax,dword ptr [esi+0x98];"
  "sub eax,0xA;"
  "je L0xABEL_0x598FDB;"
  "sub eax,0x6;"
  "je L0xABEL_0x598FEC;"
  "sub eax,edx;"
  "je L0xABEL_0x598FEC;"
  "L0xABEL_0x598F66:;"
  "push ecx;"
  "call 0x6EDE70;"
  "L0xABEL_0x598F6C:;"
  "mov ecx,dword ptr [edi+0x1C];"
  "mov eax,dword ptr [ecx];"
  "mov edx,dword ptr [eax+0x34];"
  "call edx;"
  "test al,al;"
  "jne L0xABEL_0x598F3A;"
  "mov ecx,dword ptr [edi+0x1C];"
  "mov eax,dword ptr [ecx];"
  "mov edx,dword ptr [eax+0x28];"
  "call edx;"
  "test al,al;"
  "jne L0xABEL_0x598F3A;"
  "mov ecx,dword ptr [edi+0x1C];"
  "mov eax,dword ptr [ecx];"
  "mov edx,dword ptr [eax+0x3C];"
  "push 0xE;"
  "call edx;"
  "test al,al;"
  "jne L0xABEL_0x598F3A;"
  "mov ecx,dword ptr [edi+0x1C];"
  "mov eax,dword ptr [ecx];"
  "mov edx,dword ptr [eax+0x3C];"
  "push 0x2A;"
  "call edx;"
  "test al,al;"
  "jne L0xABEL_0x598F3A;"
  "mov esi,dword ptr [edi+0x44];"
  "mov eax,esi;"
  "call 0x598B90;"
  "test al,al;"
  "jne L0xABEL_0x598F3A;"
  "mov eax,esi;"
  "call 0x6EDBF0;"
  "push eax;"
  "push edi;"
  "mov byte ptr [edi+0x40],0x1;"
  "mov dword ptr [edi+0x2C],0x0;"
  "call 0x608EF0;"
  "add esp,0x8;"
  "xor eax,eax;"
  "pop edi;"
  "pop esi;"
  "pop ebp;"
  "mov esp,ebp;"
  "pop ebp;"
  "ret;"
  "L0xABEL_0x598FDB:;"
  "cmp dword ptr [esi+0x11C],edx;"
  "sete al;"
  "test al,al;"
  "je L0xABEL_0x598F66;"
  "L0xABEL_0x598FEC:;"
  "call 0x6EDC20;"
  "test eax,eax;"
  "je L0xABEL_0x599011;"
  "mov edx,ebp;"
  "call 0x6E8D70;"
  "mov edx,dword ptr [edi+0x44];"
  "push edx;"
  "call 0x6EDFC0;"
  "mov eax,0x1;"
  "pop edi;"
  "pop esi;"
  "pop ebp;"
  "mov esp,ebp;"
  "pop ebp;"
  "ret;"
  "L0xABEL_0x599011:;"
  "push ecx;"
  "call 0x6EDE70;"
  "pop edi;"
  "mov eax,0x1;"
  "pop esi;"
  "pop ebp;"
  "mov esp,ebp;"
  "pop ebp;"
  "ret;"
);
